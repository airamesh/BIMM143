<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aishwarya Ramesh">

<title>Class 18: Pertussis Mini Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="class18_files/libs/clipboard/clipboard.min.js"></script>
<script src="class18_files/libs/quarto-html/quarto.js"></script>
<script src="class18_files/libs/quarto-html/popper.min.js"></script>
<script src="class18_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="class18_files/libs/quarto-html/anchor.min.js"></script>
<link href="class18_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="class18_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="class18_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="class18_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="class18_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Class 18: Pertussis Mini Project</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Aishwarya Ramesh </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="investigating-pertussis-cases-by-year" class="level2">
<h2 class="anchored" data-anchor-id="investigating-pertussis-cases-by-year">1. Investigating Pertussis cases by year</h2>
<section id="is-pertussis-on-the-rise" class="level3">
<h3 class="anchored" data-anchor-id="is-pertussis-on-the-rise">Is Pertussis on the rise?</h3>
<p>The CDC track reported Pertussis cases in US and make their data available here:</p>
<p>https://www.cdc.gov/pertussis/surv-reporting/cases-by-year.html</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>cdc <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">Year =</span> <span class="fu">c</span>(1922L,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                                   1923L,1924L,1925L,1926L,1927L,1928L,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                                   1929L,1930L,1931L,1932L,1933L,1934L,1935L,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                                   1936L,1937L,1938L,1939L,1940L,1941L,</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                                   1942L,1943L,1944L,1945L,1946L,1947L,1948L,</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                                   1949L,1950L,1951L,1952L,1953L,1954L,</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                                   1955L,1956L,1957L,1958L,1959L,1960L,</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                                   1961L,1962L,1963L,1964L,1965L,1966L,1967L,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                                   1968L,1969L,1970L,1971L,1972L,1973L,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                                   1974L,1975L,1976L,1977L,1978L,1979L,1980L,</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                                   1981L,1982L,1983L,1984L,1985L,1986L,</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                                   1987L,1988L,1989L,1990L,1991L,1992L,1993L,</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                                   1994L,1995L,1996L,1997L,1998L,1999L,</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>                                   2000L,2001L,2002L,2003L,2004L,2005L,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                                   2006L,2007L,2008L,2009L,2010L,2011L,2012L,</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>                                   2013L,2014L,2015L,2016L,2017L,2018L,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>                                   2019L),</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">Cases =</span> <span class="fu">c</span>(<span class="dv">107473</span>,</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">164191</span>,<span class="dv">165418</span>,<span class="dv">152003</span>,<span class="dv">202210</span>,<span class="dv">181411</span>,</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">161799</span>,<span class="dv">197371</span>,<span class="dv">166914</span>,<span class="dv">172559</span>,<span class="dv">215343</span>,<span class="dv">179135</span>,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">265269</span>,<span class="dv">180518</span>,<span class="dv">147237</span>,<span class="dv">214652</span>,<span class="dv">227319</span>,<span class="dv">103188</span>,</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">183866</span>,<span class="dv">222202</span>,<span class="dv">191383</span>,<span class="dv">191890</span>,<span class="dv">109873</span>,</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">133792</span>,<span class="dv">109860</span>,<span class="dv">156517</span>,<span class="dv">74715</span>,<span class="dv">69479</span>,<span class="dv">120718</span>,</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">68687</span>,<span class="dv">45030</span>,<span class="dv">37129</span>,<span class="dv">60886</span>,<span class="dv">62786</span>,<span class="dv">31732</span>,<span class="dv">28295</span>,</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">32148</span>,<span class="dv">40005</span>,<span class="dv">14809</span>,<span class="dv">11468</span>,<span class="dv">17749</span>,<span class="dv">17135</span>,</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">13005</span>,<span class="dv">6799</span>,<span class="dv">7717</span>,<span class="dv">9718</span>,<span class="dv">4810</span>,<span class="dv">3285</span>,<span class="dv">4249</span>,</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">3036</span>,<span class="dv">3287</span>,<span class="dv">1759</span>,<span class="dv">2402</span>,<span class="dv">1738</span>,<span class="dv">1010</span>,<span class="dv">2177</span>,<span class="dv">2063</span>,</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">1623</span>,<span class="dv">1730</span>,<span class="dv">1248</span>,<span class="dv">1895</span>,<span class="dv">2463</span>,<span class="dv">2276</span>,<span class="dv">3589</span>,</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">4195</span>,<span class="dv">2823</span>,<span class="dv">3450</span>,<span class="dv">4157</span>,<span class="dv">4570</span>,<span class="dv">2719</span>,<span class="dv">4083</span>,<span class="dv">6586</span>,</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">4617</span>,<span class="dv">5137</span>,<span class="dv">7796</span>,<span class="dv">6564</span>,<span class="dv">7405</span>,<span class="dv">7298</span>,<span class="dv">7867</span>,</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">7580</span>,<span class="dv">9771</span>,<span class="dv">11647</span>,<span class="dv">25827</span>,<span class="dv">25616</span>,<span class="dv">15632</span>,<span class="dv">10454</span>,</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">13278</span>,<span class="dv">16858</span>,<span class="dv">27550</span>,<span class="dv">18719</span>,<span class="dv">48277</span>,<span class="dv">28639</span>,</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>                                   <span class="dv">32971</span>,<span class="dv">20762</span>,<span class="dv">17972</span>,<span class="dv">18975</span>,<span class="dv">15609</span>,<span class="dv">18617</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Viewing the data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(cdc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Year  Cases
1 1922 107473
2 1923 164191
3 1924 165418
4 1925 152003
5 1926 202210
6 1927 181411</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q1. With the help of the R “addin” package datapasta assign the CDC pertussis case number data to a data frame called cdc and use ggplot to make a plot of cases numbers over time.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>baseplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cdc) <span class="sc">+</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x=</span>Year, <span class="at">y=</span>Cases)<span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of reported Pertussis Cases per Year"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>baseplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class18_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="a-tale-of-two-vaccines-wp-and-ap" class="level2">
<h2 class="anchored" data-anchor-id="a-tale-of-two-vaccines-wp-and-ap">2. A tale of two vaccines (wP and aP)</h2>
<blockquote class="blockquote">
<p>Q2. Using the ggplot geom_vline() function add lines to your previous plot for the 1946 introduction of the wP vaccine and the 1996 switch to aP vaccine (see example in the hint below). What do you notice?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>baseplot <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">1946</span>, </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype=</span><span class="st">'dashed'</span>, </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">color=</span> <span class="st">'blue'</span>) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span><span class="dv">1996</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>             <span class="at">linetype=</span><span class="st">'dashed'</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>             <span class="at">color=</span><span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class18_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>After the introduction of the wP vaccine in 1946, the number of annual cases reduced dramatically. Levels remained low in 1996 when the aP vaccine was introduced. Around 2000, the cases started to increase again.</p>
<blockquote class="blockquote">
<p>Q3. Describe what happened after the introduction of the aP vaccine? Do you have a possible explanation for the observed trend?</p>
</blockquote>
<p>After the introduction of the aP vaccine, the number of annual pertussis cases started to increase. Some potential explanations for the observed trend include increased anti-vaccination sentiment in the population, vaccine wearing off over time (requiring booster shot) or vaccines not covering enough variants of pertussis.</p>
</section>
<section id="exploring-cmi-pb-data" class="level2">
<h2 class="anchored" data-anchor-id="exploring-cmi-pb-data">3. Exploring CMI-PB data</h2>
<section id="the-cmi-pb-returns-json-data" class="level3">
<h3 class="anchored" data-anchor-id="the-cmi-pb-returns-json-data">The CMI-PB returns JSON data</h3>
<p>The CMI-PB resource is studying and makign availavle data on the immune response to Pertussis vaccination</p>
<p>It mostly returns JSON format data that we need to process and convert into something usable in R.</p>
<p>We will use the <code>jsonlite</code> package for this.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>subject <span class="ot">&lt;-</span> <span class="fu">read_json</span>(<span class="st">"https://www.cmi-pb.org/api/subject"</span>, <span class="at">simplifyVector =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>subject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   subject_id infancy_vac biological_sex              ethnicity
1           1          wP         Female Not Hispanic or Latino
2           2          wP         Female Not Hispanic or Latino
3           3          wP         Female                Unknown
4           4          wP           Male Not Hispanic or Latino
5           5          wP           Male Not Hispanic or Latino
6           6          wP         Female Not Hispanic or Latino
7           7          wP         Female     Hispanic or Latino
8           8          wP         Female Not Hispanic or Latino
9           9          aP           Male Not Hispanic or Latino
10         10          wP         Female Not Hispanic or Latino
11         11          wP         Female     Hispanic or Latino
12         12          wP           Male Not Hispanic or Latino
13         13          aP           Male Not Hispanic or Latino
14         14          wP           Male Not Hispanic or Latino
15         15          wP           Male Not Hispanic or Latino
16         16          wP         Female     Hispanic or Latino
17         17          wP         Female     Hispanic or Latino
18         18          aP         Female     Hispanic or Latino
19         19          wP           Male Not Hispanic or Latino
20         61          wP         Female Not Hispanic or Latino
21         62          wP         Female Not Hispanic or Latino
22         63          wP         Female Not Hispanic or Latino
23         64          wP           Male Not Hispanic or Latino
24         65          wP           Male Not Hispanic or Latino
25         66          wP         Female Not Hispanic or Latino
26         67          wP         Female     Hispanic or Latino
27         68          wP           Male     Hispanic or Latino
28         69          wP         Female     Hispanic or Latino
29         70          aP           Male Not Hispanic or Latino
30         71          aP         Female Not Hispanic or Latino
31         72          wP         Female Not Hispanic or Latino
32         73          wP         Female Not Hispanic or Latino
33         74          wP         Female Not Hispanic or Latino
34         75          aP         Female Not Hispanic or Latino
35         76          aP         Female Not Hispanic or Latino
36         77          wP           Male Not Hispanic or Latino
37         78          wP         Female Not Hispanic or Latino
38         79          wP           Male Not Hispanic or Latino
39         80          wP         Female Not Hispanic or Latino
40         81          wP           Male Not Hispanic or Latino
41         82          aP         Female Not Hispanic or Latino
42         83          aP         Female Not Hispanic or Latino
43         84          aP         Female Not Hispanic or Latino
44         85          aP         Female     Hispanic or Latino
45         86          aP         Female Not Hispanic or Latino
46         87          aP           Male Not Hispanic or Latino
47         88          aP           Male Not Hispanic or Latino
48         89          aP         Female Not Hispanic or Latino
49         90          aP         Female Not Hispanic or Latino
50         91          aP           Male                Unknown
51         92          aP         Female     Hispanic or Latino
52         93          aP         Female Not Hispanic or Latino
53         94          aP           Male Not Hispanic or Latino
54         95          aP         Female     Hispanic or Latino
55         96          aP           Male     Hispanic or Latino
56         20          wP         Female Not Hispanic or Latino
57         21          wP           Male Not Hispanic or Latino
58         22          wP         Female Not Hispanic or Latino
59         23          wP         Female Not Hispanic or Latino
60         24          wP         Female Not Hispanic or Latino
61         25          wP         Female Not Hispanic or Latino
62         26          wP         Female     Hispanic or Latino
63         27          aP         Female Not Hispanic or Latino
64         28          wP           Male                Unknown
65         29          aP           Male     Hispanic or Latino
66         30          wP         Female     Hispanic or Latino
67         31          wP         Female Not Hispanic or Latino
68         32          aP           Male Not Hispanic or Latino
69         33          wP           Male     Hispanic or Latino
70         34          wP         Female     Hispanic or Latino
71         35          wP           Male                Unknown
72         36          aP         Female     Hispanic or Latino
73         37          aP         Female Not Hispanic or Latino
74         38          aP         Female Not Hispanic or Latino
75         39          wP         Female Not Hispanic or Latino
76         40          wP         Female Not Hispanic or Latino
77         41          wP           Male Not Hispanic or Latino
78         42          aP         Female Not Hispanic or Latino
79         43          aP         Female Not Hispanic or Latino
80         44          aP         Female     Hispanic or Latino
81         45          aP         Female Not Hispanic or Latino
82         46          aP         Female Not Hispanic or Latino
83         47          aP         Female Not Hispanic or Latino
84         48          aP         Female Not Hispanic or Latino
85         49          aP         Female Not Hispanic or Latino
86         50          aP         Female Not Hispanic or Latino
87         51          aP           Male Not Hispanic or Latino
88         52          aP           Male Not Hispanic or Latino
89         53          aP         Female     Hispanic or Latino
90         54          aP         Female Not Hispanic or Latino
91         55          aP         Female Not Hispanic or Latino
92         56          aP         Female Not Hispanic or Latino
93         57          aP         Female Not Hispanic or Latino
94         58          aP         Female     Hispanic or Latino
95         59          aP         Female     Hispanic or Latino
96         60          aP           Male     Hispanic or Latino
                                        race year_of_birth date_of_boost
1                                      White    1986-01-01    2016-09-12
2                                      White    1968-01-01    2019-01-28
3                                      White    1983-01-01    2016-10-10
4                                      Asian    1988-01-01    2016-08-29
5                                      Asian    1991-01-01    2016-08-29
6                                      White    1988-01-01    2016-10-10
7                         More Than One Race    1981-01-01    2016-11-07
8                                      White    1985-01-01    2019-02-25
9                                      Asian    1996-01-01    2016-07-25
10                                     Asian    1982-01-01    2016-07-25
11                   Unknown or Not Reported    1986-01-01    2016-08-29
12                                     Asian    1982-01-01    2016-07-25
13                                     White    1997-01-01    2016-07-25
14                                     White    1993-01-01    2016-08-15
15                                     Asian    1989-01-01    2016-08-15
16                   Unknown or Not Reported    1987-01-01    2016-07-25
17                                     White    1980-01-01    2016-09-12
18                   Unknown or Not Reported    1997-01-01    2016-08-29
19                                     Asian    1994-01-01    2016-09-26
20                   Unknown or Not Reported    1987-01-01    2019-04-08
21                                     Asian    1993-01-01    2018-11-26
22                                     White    1995-01-01    2018-11-26
23                                     Asian    1993-01-01    2018-11-26
24                                     White    1990-01-01    2018-12-03
25                 Black or African American    1976-01-01    2018-12-03
26                                     White    1972-01-01    2019-01-28
27                                     White    1972-01-01    2019-01-28
28                                     White    1990-01-01    2019-01-28
29             American Indian/Alaska Native    1998-01-01    2019-01-28
30                                     White    1998-01-01    2019-01-28
31                                     White    1991-01-01    2019-02-25
32                                     White    1995-01-01    2019-02-25
33                                     White    1995-01-01    2019-02-25
34 Native Hawaiian or Other Pacific Islander    1998-01-01    2019-02-25
35                                     Asian    1998-01-01    2019-02-25
36                                     White    1988-01-01    2019-03-18
37                                     White    1993-01-01    2019-03-18
38                                     White    1987-01-01    2019-03-18
39                                     Asian    1992-01-01    2019-03-18
40                                     White    1993-01-01    2019-03-18
41                        More Than One Race    1998-01-01    2019-03-18
42                                     White    1999-01-01    2019-04-08
43                        More Than One Race    1997-01-01    2019-04-08
44                                     White    2000-01-01    2019-04-29
45                                     Asian    1998-01-01    2019-04-29
46                                     Asian    2000-01-01    2019-04-29
47                                     Asian    2000-01-01    2019-04-29
48                                     Asian    1997-01-01    2019-06-03
49                                     Asian    1999-01-01    2019-06-03
50                   Unknown or Not Reported    1998-01-01    2019-06-03
51                                     White    2000-01-01    2019-06-24
52                        More Than One Race    1996-01-01    2019-06-24
53                   Unknown or Not Reported    1999-01-01    2019-06-24
54                   Unknown or Not Reported    1998-01-01    2019-06-24
55                   Unknown or Not Reported    2000-01-01    2019-06-24
56                                     White    1981-01-01    2016-08-29
57                                     White    1983-01-01    2016-08-29
58                                     White    1985-01-01    2016-08-29
59                                     White    1991-01-01    2016-09-26
60                                     Asian    1992-01-01    2016-09-13
61                 Black or African American    1988-01-01    2016-09-13
62                   Unknown or Not Reported    1983-01-01    2016-09-26
63                                     Asian    1997-01-01    2016-09-26
64                   Unknown or Not Reported    1982-01-01    2016-09-26
65                                     White    1997-01-01    2016-09-26
66                                     White    1988-01-01    2016-09-26
67                                     Asian    1989-01-01    2016-09-26
68 Native Hawaiian or Other Pacific Islander    1997-01-01    2016-10-24
69                        More Than One Race    1990-01-01    2016-10-10
70                   Unknown or Not Reported    1983-01-01    2016-10-24
71                                     White    1991-01-01    2016-10-10
72                                     White    1997-01-01    2016-10-24
73                        More Than One Race    1998-01-01    2016-11-07
74                                     White    1997-01-01    2016-10-24
75                                     White    1985-01-01    2016-10-24
76                                     Asian    1994-01-01    2016-10-24
77                                     White    1985-01-01    2016-11-07
78                                     Asian    1997-01-01    2016-11-07
79                        More Than One Race    1998-01-01    2016-11-07
80                        More Than One Race    1998-01-01    2016-11-07
81                                     Asian    1997-01-01    2016-11-28
82                   Unknown or Not Reported    1998-01-01    2016-11-07
83                                     White    1996-01-01    2016-11-28
84                                     White    1998-01-01    2017-01-17
85                                     White    1997-01-01    2017-01-17
86                                     Asian    1997-01-01    2016-11-28
87                                     White    1997-01-01    2016-11-28
88                        More Than One Race    1998-01-01    2017-01-03
89                   Unknown or Not Reported    1998-01-01    2017-01-03
90                                     Asian    1997-01-01    2017-01-17
91                                     Asian    1997-01-01    2017-01-17
92                                     Asian    1997-01-01    2017-01-30
93                                     Asian    1996-01-01    2017-01-30
94                   Unknown or Not Reported    1997-01-01    2017-01-30
95                        More Than One Race    1997-01-01    2017-01-30
96                                     White    1997-01-01    2017-01-30
        dataset
1  2020_dataset
2  2020_dataset
3  2020_dataset
4  2020_dataset
5  2020_dataset
6  2020_dataset
7  2020_dataset
8  2020_dataset
9  2020_dataset
10 2020_dataset
11 2020_dataset
12 2020_dataset
13 2020_dataset
14 2020_dataset
15 2020_dataset
16 2020_dataset
17 2020_dataset
18 2020_dataset
19 2020_dataset
20 2021_dataset
21 2021_dataset
22 2021_dataset
23 2021_dataset
24 2021_dataset
25 2021_dataset
26 2021_dataset
27 2021_dataset
28 2021_dataset
29 2021_dataset
30 2021_dataset
31 2021_dataset
32 2021_dataset
33 2021_dataset
34 2021_dataset
35 2021_dataset
36 2021_dataset
37 2021_dataset
38 2021_dataset
39 2021_dataset
40 2021_dataset
41 2021_dataset
42 2021_dataset
43 2021_dataset
44 2021_dataset
45 2021_dataset
46 2021_dataset
47 2021_dataset
48 2021_dataset
49 2021_dataset
50 2021_dataset
51 2021_dataset
52 2021_dataset
53 2021_dataset
54 2021_dataset
55 2021_dataset
56 2020_dataset
57 2020_dataset
58 2020_dataset
59 2020_dataset
60 2020_dataset
61 2020_dataset
62 2020_dataset
63 2020_dataset
64 2020_dataset
65 2020_dataset
66 2020_dataset
67 2020_dataset
68 2020_dataset
69 2020_dataset
70 2020_dataset
71 2020_dataset
72 2020_dataset
73 2020_dataset
74 2020_dataset
75 2020_dataset
76 2020_dataset
77 2020_dataset
78 2020_dataset
79 2020_dataset
80 2020_dataset
81 2020_dataset
82 2020_dataset
83 2020_dataset
84 2020_dataset
85 2020_dataset
86 2020_dataset
87 2020_dataset
88 2020_dataset
89 2020_dataset
90 2020_dataset
91 2020_dataset
92 2020_dataset
93 2020_dataset
94 2020_dataset
95 2020_dataset
96 2020_dataset</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q4. How may aP and wP infancy vaccinated subjects are in the dataset?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(subject<span class="sc">$</span>infancy_vac)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
aP wP 
47 49 </code></pre>
</div>
</div>
<p>47 aP vaccinated and 49 wP vaccinated in the dataset</p>
<blockquote class="blockquote">
<p>Q5. How many Male and Female subjects/patients are in the dataset?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(subject<span class="sc">$</span>biological_sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Female   Male 
    66     30 </code></pre>
</div>
</div>
<p>66 females and 30 males in the dataset</p>
<blockquote class="blockquote">
<p>Q6. What is the breakdown of race and biological sex (e.g.&nbsp;number of Asian females, White males etc…)?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(subject<span class="sc">$</span>race, subject<span class="sc">$</span>biological_sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                           
                                            Female Male
  American Indian/Alaska Native                  0    1
  Asian                                         18    9
  Black or African American                      2    0
  More Than One Race                             8    2
  Native Hawaiian or Other Pacific Islander      1    1
  Unknown or Not Reported                       10    4
  White                                         27   13</code></pre>
</div>
</div>
</section>
<section id="side-note-working-with-dates" class="level3">
<h3 class="anchored" data-anchor-id="side-note-working-with-dates">Side-Note: Working with dates</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: timechange</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">today</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2022-11-29"</code></pre>
</div>
</div>
<p>Time passed between New Year’s day 2000 and today.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">today</span>() <span class="sc">-</span> <span class="fu">ymd</span>(<span class="st">"2000-01-01"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Time difference of 8368 days</code></pre>
</div>
</div>
<p>That value in years:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">time_length</span>( <span class="fu">today</span>() <span class="sc">-</span> <span class="fu">ymd</span>(<span class="st">"2000-01-01"</span>),  <span class="st">"years"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22.91034</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q7. Using this approach determine (i) the average age of wP individuals, (ii) the average age of aP individuals; and (iii) are they significantly different?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>subject<span class="sc">$</span>age <span class="ot">&lt;-</span> <span class="fu">today</span>() <span class="sc">-</span> <span class="fu">ymd</span>(subject<span class="sc">$</span>year_of_birth)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>subject</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   subject_id infancy_vac biological_sex              ethnicity
1           1          wP         Female Not Hispanic or Latino
2           2          wP         Female Not Hispanic or Latino
3           3          wP         Female                Unknown
4           4          wP           Male Not Hispanic or Latino
5           5          wP           Male Not Hispanic or Latino
6           6          wP         Female Not Hispanic or Latino
7           7          wP         Female     Hispanic or Latino
8           8          wP         Female Not Hispanic or Latino
9           9          aP           Male Not Hispanic or Latino
10         10          wP         Female Not Hispanic or Latino
11         11          wP         Female     Hispanic or Latino
12         12          wP           Male Not Hispanic or Latino
13         13          aP           Male Not Hispanic or Latino
14         14          wP           Male Not Hispanic or Latino
15         15          wP           Male Not Hispanic or Latino
16         16          wP         Female     Hispanic or Latino
17         17          wP         Female     Hispanic or Latino
18         18          aP         Female     Hispanic or Latino
19         19          wP           Male Not Hispanic or Latino
20         61          wP         Female Not Hispanic or Latino
21         62          wP         Female Not Hispanic or Latino
22         63          wP         Female Not Hispanic or Latino
23         64          wP           Male Not Hispanic or Latino
24         65          wP           Male Not Hispanic or Latino
25         66          wP         Female Not Hispanic or Latino
26         67          wP         Female     Hispanic or Latino
27         68          wP           Male     Hispanic or Latino
28         69          wP         Female     Hispanic or Latino
29         70          aP           Male Not Hispanic or Latino
30         71          aP         Female Not Hispanic or Latino
31         72          wP         Female Not Hispanic or Latino
32         73          wP         Female Not Hispanic or Latino
33         74          wP         Female Not Hispanic or Latino
34         75          aP         Female Not Hispanic or Latino
35         76          aP         Female Not Hispanic or Latino
36         77          wP           Male Not Hispanic or Latino
37         78          wP         Female Not Hispanic or Latino
38         79          wP           Male Not Hispanic or Latino
39         80          wP         Female Not Hispanic or Latino
40         81          wP           Male Not Hispanic or Latino
41         82          aP         Female Not Hispanic or Latino
42         83          aP         Female Not Hispanic or Latino
43         84          aP         Female Not Hispanic or Latino
44         85          aP         Female     Hispanic or Latino
45         86          aP         Female Not Hispanic or Latino
46         87          aP           Male Not Hispanic or Latino
47         88          aP           Male Not Hispanic or Latino
48         89          aP         Female Not Hispanic or Latino
49         90          aP         Female Not Hispanic or Latino
50         91          aP           Male                Unknown
51         92          aP         Female     Hispanic or Latino
52         93          aP         Female Not Hispanic or Latino
53         94          aP           Male Not Hispanic or Latino
54         95          aP         Female     Hispanic or Latino
55         96          aP           Male     Hispanic or Latino
56         20          wP         Female Not Hispanic or Latino
57         21          wP           Male Not Hispanic or Latino
58         22          wP         Female Not Hispanic or Latino
59         23          wP         Female Not Hispanic or Latino
60         24          wP         Female Not Hispanic or Latino
61         25          wP         Female Not Hispanic or Latino
62         26          wP         Female     Hispanic or Latino
63         27          aP         Female Not Hispanic or Latino
64         28          wP           Male                Unknown
65         29          aP           Male     Hispanic or Latino
66         30          wP         Female     Hispanic or Latino
67         31          wP         Female Not Hispanic or Latino
68         32          aP           Male Not Hispanic or Latino
69         33          wP           Male     Hispanic or Latino
70         34          wP         Female     Hispanic or Latino
71         35          wP           Male                Unknown
72         36          aP         Female     Hispanic or Latino
73         37          aP         Female Not Hispanic or Latino
74         38          aP         Female Not Hispanic or Latino
75         39          wP         Female Not Hispanic or Latino
76         40          wP         Female Not Hispanic or Latino
77         41          wP           Male Not Hispanic or Latino
78         42          aP         Female Not Hispanic or Latino
79         43          aP         Female Not Hispanic or Latino
80         44          aP         Female     Hispanic or Latino
81         45          aP         Female Not Hispanic or Latino
82         46          aP         Female Not Hispanic or Latino
83         47          aP         Female Not Hispanic or Latino
84         48          aP         Female Not Hispanic or Latino
85         49          aP         Female Not Hispanic or Latino
86         50          aP         Female Not Hispanic or Latino
87         51          aP           Male Not Hispanic or Latino
88         52          aP           Male Not Hispanic or Latino
89         53          aP         Female     Hispanic or Latino
90         54          aP         Female Not Hispanic or Latino
91         55          aP         Female Not Hispanic or Latino
92         56          aP         Female Not Hispanic or Latino
93         57          aP         Female Not Hispanic or Latino
94         58          aP         Female     Hispanic or Latino
95         59          aP         Female     Hispanic or Latino
96         60          aP           Male     Hispanic or Latino
                                        race year_of_birth date_of_boost
1                                      White    1986-01-01    2016-09-12
2                                      White    1968-01-01    2019-01-28
3                                      White    1983-01-01    2016-10-10
4                                      Asian    1988-01-01    2016-08-29
5                                      Asian    1991-01-01    2016-08-29
6                                      White    1988-01-01    2016-10-10
7                         More Than One Race    1981-01-01    2016-11-07
8                                      White    1985-01-01    2019-02-25
9                                      Asian    1996-01-01    2016-07-25
10                                     Asian    1982-01-01    2016-07-25
11                   Unknown or Not Reported    1986-01-01    2016-08-29
12                                     Asian    1982-01-01    2016-07-25
13                                     White    1997-01-01    2016-07-25
14                                     White    1993-01-01    2016-08-15
15                                     Asian    1989-01-01    2016-08-15
16                   Unknown or Not Reported    1987-01-01    2016-07-25
17                                     White    1980-01-01    2016-09-12
18                   Unknown or Not Reported    1997-01-01    2016-08-29
19                                     Asian    1994-01-01    2016-09-26
20                   Unknown or Not Reported    1987-01-01    2019-04-08
21                                     Asian    1993-01-01    2018-11-26
22                                     White    1995-01-01    2018-11-26
23                                     Asian    1993-01-01    2018-11-26
24                                     White    1990-01-01    2018-12-03
25                 Black or African American    1976-01-01    2018-12-03
26                                     White    1972-01-01    2019-01-28
27                                     White    1972-01-01    2019-01-28
28                                     White    1990-01-01    2019-01-28
29             American Indian/Alaska Native    1998-01-01    2019-01-28
30                                     White    1998-01-01    2019-01-28
31                                     White    1991-01-01    2019-02-25
32                                     White    1995-01-01    2019-02-25
33                                     White    1995-01-01    2019-02-25
34 Native Hawaiian or Other Pacific Islander    1998-01-01    2019-02-25
35                                     Asian    1998-01-01    2019-02-25
36                                     White    1988-01-01    2019-03-18
37                                     White    1993-01-01    2019-03-18
38                                     White    1987-01-01    2019-03-18
39                                     Asian    1992-01-01    2019-03-18
40                                     White    1993-01-01    2019-03-18
41                        More Than One Race    1998-01-01    2019-03-18
42                                     White    1999-01-01    2019-04-08
43                        More Than One Race    1997-01-01    2019-04-08
44                                     White    2000-01-01    2019-04-29
45                                     Asian    1998-01-01    2019-04-29
46                                     Asian    2000-01-01    2019-04-29
47                                     Asian    2000-01-01    2019-04-29
48                                     Asian    1997-01-01    2019-06-03
49                                     Asian    1999-01-01    2019-06-03
50                   Unknown or Not Reported    1998-01-01    2019-06-03
51                                     White    2000-01-01    2019-06-24
52                        More Than One Race    1996-01-01    2019-06-24
53                   Unknown or Not Reported    1999-01-01    2019-06-24
54                   Unknown or Not Reported    1998-01-01    2019-06-24
55                   Unknown or Not Reported    2000-01-01    2019-06-24
56                                     White    1981-01-01    2016-08-29
57                                     White    1983-01-01    2016-08-29
58                                     White    1985-01-01    2016-08-29
59                                     White    1991-01-01    2016-09-26
60                                     Asian    1992-01-01    2016-09-13
61                 Black or African American    1988-01-01    2016-09-13
62                   Unknown or Not Reported    1983-01-01    2016-09-26
63                                     Asian    1997-01-01    2016-09-26
64                   Unknown or Not Reported    1982-01-01    2016-09-26
65                                     White    1997-01-01    2016-09-26
66                                     White    1988-01-01    2016-09-26
67                                     Asian    1989-01-01    2016-09-26
68 Native Hawaiian or Other Pacific Islander    1997-01-01    2016-10-24
69                        More Than One Race    1990-01-01    2016-10-10
70                   Unknown or Not Reported    1983-01-01    2016-10-24
71                                     White    1991-01-01    2016-10-10
72                                     White    1997-01-01    2016-10-24
73                        More Than One Race    1998-01-01    2016-11-07
74                                     White    1997-01-01    2016-10-24
75                                     White    1985-01-01    2016-10-24
76                                     Asian    1994-01-01    2016-10-24
77                                     White    1985-01-01    2016-11-07
78                                     Asian    1997-01-01    2016-11-07
79                        More Than One Race    1998-01-01    2016-11-07
80                        More Than One Race    1998-01-01    2016-11-07
81                                     Asian    1997-01-01    2016-11-28
82                   Unknown or Not Reported    1998-01-01    2016-11-07
83                                     White    1996-01-01    2016-11-28
84                                     White    1998-01-01    2017-01-17
85                                     White    1997-01-01    2017-01-17
86                                     Asian    1997-01-01    2016-11-28
87                                     White    1997-01-01    2016-11-28
88                        More Than One Race    1998-01-01    2017-01-03
89                   Unknown or Not Reported    1998-01-01    2017-01-03
90                                     Asian    1997-01-01    2017-01-17
91                                     Asian    1997-01-01    2017-01-17
92                                     Asian    1997-01-01    2017-01-30
93                                     Asian    1996-01-01    2017-01-30
94                   Unknown or Not Reported    1997-01-01    2017-01-30
95                        More Than One Race    1997-01-01    2017-01-30
96                                     White    1997-01-01    2017-01-30
        dataset        age
1  2020_dataset 13481 days
2  2020_dataset 20056 days
3  2020_dataset 14577 days
4  2020_dataset 12751 days
5  2020_dataset 11655 days
6  2020_dataset 12751 days
7  2020_dataset 15307 days
8  2020_dataset 13846 days
9  2020_dataset  9829 days
10 2020_dataset 14942 days
11 2020_dataset 13481 days
12 2020_dataset 14942 days
13 2020_dataset  9463 days
14 2020_dataset 10924 days
15 2020_dataset 12385 days
16 2020_dataset 13116 days
17 2020_dataset 15673 days
18 2020_dataset  9463 days
19 2020_dataset 10559 days
20 2021_dataset 13116 days
21 2021_dataset 10924 days
22 2021_dataset 10194 days
23 2021_dataset 10924 days
24 2021_dataset 12020 days
25 2021_dataset 17134 days
26 2021_dataset 18595 days
27 2021_dataset 18595 days
28 2021_dataset 12020 days
29 2021_dataset  9098 days
30 2021_dataset  9098 days
31 2021_dataset 11655 days
32 2021_dataset 10194 days
33 2021_dataset 10194 days
34 2021_dataset  9098 days
35 2021_dataset  9098 days
36 2021_dataset 12751 days
37 2021_dataset 10924 days
38 2021_dataset 13116 days
39 2021_dataset 11290 days
40 2021_dataset 10924 days
41 2021_dataset  9098 days
42 2021_dataset  8733 days
43 2021_dataset  9463 days
44 2021_dataset  8368 days
45 2021_dataset  9098 days
46 2021_dataset  8368 days
47 2021_dataset  8368 days
48 2021_dataset  9463 days
49 2021_dataset  8733 days
50 2021_dataset  9098 days
51 2021_dataset  8368 days
52 2021_dataset  9829 days
53 2021_dataset  8733 days
54 2021_dataset  9098 days
55 2021_dataset  8368 days
56 2020_dataset 15307 days
57 2020_dataset 14577 days
58 2020_dataset 13846 days
59 2020_dataset 11655 days
60 2020_dataset 11290 days
61 2020_dataset 12751 days
62 2020_dataset 14577 days
63 2020_dataset  9463 days
64 2020_dataset 14942 days
65 2020_dataset  9463 days
66 2020_dataset 12751 days
67 2020_dataset 12385 days
68 2020_dataset  9463 days
69 2020_dataset 12020 days
70 2020_dataset 14577 days
71 2020_dataset 11655 days
72 2020_dataset  9463 days
73 2020_dataset  9098 days
74 2020_dataset  9463 days
75 2020_dataset 13846 days
76 2020_dataset 10559 days
77 2020_dataset 13846 days
78 2020_dataset  9463 days
79 2020_dataset  9098 days
80 2020_dataset  9098 days
81 2020_dataset  9463 days
82 2020_dataset  9098 days
83 2020_dataset  9829 days
84 2020_dataset  9098 days
85 2020_dataset  9463 days
86 2020_dataset  9463 days
87 2020_dataset  9463 days
88 2020_dataset  9098 days
89 2020_dataset  9098 days
90 2020_dataset  9463 days
91 2020_dataset  9463 days
92 2020_dataset  9463 days
93 2020_dataset  9829 days
94 2020_dataset  9463 days
95 2020_dataset  9463 days
96 2020_dataset  9463 days</code></pre>
</div>
</div>
<ol type="i">
<li>Filtering for wP</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>wp <span class="ot">&lt;-</span>  subject <span class="sc">%&gt;%</span> <span class="fu">filter</span>(infancy_vac <span class="sc">==</span> <span class="st">'wP'</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">summary</span>(<span class="fu">time_length</span>(wp<span class="sc">$</span>age, <span class="st">'years'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     28      32      35      36      40      55 </code></pre>
</div>
</div>
<p>The average age of wP individuals is 36 years of age</p>
<ol start="2" type="i">
<li>Filtering for aP</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>ap <span class="ot">&lt;-</span>  subject <span class="sc">%&gt;%</span> <span class="fu">filter</span>(infancy_vac <span class="sc">==</span> <span class="st">'aP'</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">summary</span>(<span class="fu">time_length</span>(ap<span class="sc">$</span>age, <span class="st">'years'</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
     23      25      26      25      26      27 </code></pre>
</div>
</div>
<p>The average age of aP individuals is 25 years of age.</p>
<ol start="3" type="i">
<li>The mean ages are significantly different, with a 11 year age difference between them.</li>
</ol>
<blockquote class="blockquote">
<p>Q8. Determine the age of all individuals at time of boost?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>int <span class="ot">&lt;-</span> <span class="fu">ymd</span>(subject<span class="sc">$</span>date_of_boost) <span class="sc">-</span> <span class="fu">ymd</span>(subject<span class="sc">$</span>year_of_birth)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>age_at_boost <span class="ot">&lt;-</span> <span class="fu">time_length</span>(int, <span class="st">"year"</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(age_at_boost)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30.69678 51.07461 33.77413 28.65982 25.65914 28.77481</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q9. With the help of a faceted boxplot (see below), do you think these two groups are significantly different?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(subject) <span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="fu">time_length</span>(age, <span class="st">"year"</span>),</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill=</span><span class="fu">as.factor</span>(infancy_vac)) <span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(infancy_vac), <span class="at">nrow=</span><span class="dv">2</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="class18_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="joining-multiple-tables" class="level3">
<h3 class="anchored" data-anchor-id="joining-multiple-tables">Joining multiple tables</h3>
<p>Reading in data on specimens and titer</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>specimen <span class="ot">&lt;-</span> <span class="fu">read_json</span>(<span class="st">"http://cmi-pb.org/api/specimen"</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">simplifyVector=</span><span class="cn">TRUE</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>titer <span class="ot">&lt;-</span> <span class="fu">read_json</span>(<span class="st">"https://www.cmi-pb.org/api/ab_titer"</span>, </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">simplifyVector =</span><span class="cn">TRUE</span>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(specimen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  specimen_id subject_id actual_day_relative_to_boost
1           1          1                           -3
2           2          1                          736
3           3          1                            1
4           4          1                            3
5           5          1                            7
6           6          1                           11
  planned_day_relative_to_boost specimen_type visit
1                             0         Blood     1
2                           736         Blood    10
3                             1         Blood     2
4                             3         Blood     3
5                             7         Blood     4
6                            14         Blood     5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(titer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  specimen_id isotype is_antigen_specific antigen        MFI MFI_normalised
1           1     IgE               FALSE   Total 1110.21154       2.493425
2           1     IgE               FALSE   Total 2708.91616       2.493425
3           1     IgG                TRUE      PT   68.56614       3.736992
4           1     IgG                TRUE     PRN  332.12718       2.602350
5           1     IgG                TRUE     FHA 1887.12263      34.050956
6           1     IgE                TRUE     ACT    0.10000       1.000000
   unit lower_limit_of_detection
1 UG/ML                 2.096133
2 IU/ML                29.170000
3 IU/ML                 0.530000
4 IU/ML                 6.205949
5 IU/ML                 4.679535
6 IU/ML                 2.816431</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q9. Complete the code to join specimen and subject tables to make a new merged data frame containing all specimen records along with their associated subject details:</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>meta <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(specimen, subject)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = "subject_id"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(meta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 729  14</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(meta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  specimen_id subject_id actual_day_relative_to_boost
1           1          1                           -3
2           2          1                          736
3           3          1                            1
4           4          1                            3
5           5          1                            7
6           6          1                           11
  planned_day_relative_to_boost specimen_type visit infancy_vac biological_sex
1                             0         Blood     1          wP         Female
2                           736         Blood    10          wP         Female
3                             1         Blood     2          wP         Female
4                             3         Blood     3          wP         Female
5                             7         Blood     4          wP         Female
6                            14         Blood     5          wP         Female
               ethnicity  race year_of_birth date_of_boost      dataset
1 Not Hispanic or Latino White    1986-01-01    2016-09-12 2020_dataset
2 Not Hispanic or Latino White    1986-01-01    2016-09-12 2020_dataset
3 Not Hispanic or Latino White    1986-01-01    2016-09-12 2020_dataset
4 Not Hispanic or Latino White    1986-01-01    2016-09-12 2020_dataset
5 Not Hispanic or Latino White    1986-01-01    2016-09-12 2020_dataset
6 Not Hispanic or Latino White    1986-01-01    2016-09-12 2020_dataset
         age
1 13481 days
2 13481 days
3 13481 days
4 13481 days
5 13481 days
6 13481 days</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(specimen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 729   6</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(subject)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 96  9</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q10. Now using the same procedure join meta with titer data so we can further analyze this data in terms of time of visit aP/wP, male/female etc.</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>abdata <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(titer, meta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining, by = "specimen_id"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(abdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32675    21</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q11. How many specimens (i.e.&nbsp;entries in abdata) do we have for each isotype?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(abdata<span class="sc">$</span>isotype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
 IgE  IgG IgG1 IgG2 IgG3 IgG4 
6698 1413 6141 6141 6141 6141 </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q12. What do you notice about the number of visit 8 specimens compared to other visits?</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(abdata<span class="sc">$</span>visit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   1    2    3    4    5    6    7    8 
5795 4640 4640 4640 4640 4320 3920   80 </code></pre>
</div>
</div>
<p>The number of visit 8 specimens is extremely low in comparison to the rest of the visits.</p>
</section>
</section>
<section id="examine-igg1-ab-titer-levels" class="level2">
<h2 class="anchored" data-anchor-id="examine-igg1-ab-titer-levels">4. Examine IgG1 Ab Titer Levels</h2>
<p>Filtering for IgG1 isotype and excluding visit 8 specimens since there are very few of them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>ig1 <span class="ot">&lt;-</span> abdata <span class="sc">%&gt;%</span> <span class="fu">filter</span>(isotype <span class="sc">==</span> <span class="st">"IgG1"</span>, visit<span class="sc">!=</span><span class="dv">8</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ig1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  specimen_id isotype is_antigen_specific antigen        MFI MFI_normalised
1           1    IgG1                TRUE     ACT 274.355068      0.6928058
2           1    IgG1                TRUE     LOS  10.974026      2.1645083
3           1    IgG1                TRUE   FELD1   1.448796      0.8080941
4           1    IgG1                TRUE   BETV1   0.100000      1.0000000
5           1    IgG1                TRUE   LOLP1   0.100000      1.0000000
6           1    IgG1                TRUE Measles  36.277417      1.6638332
   unit lower_limit_of_detection subject_id actual_day_relative_to_boost
1 IU/ML                 3.848750          1                           -3
2 IU/ML                 4.357917          1                           -3
3 IU/ML                 2.699944          1                           -3
4 IU/ML                 1.734784          1                           -3
5 IU/ML                 2.550606          1                           -3
6 IU/ML                 4.438966          1                           -3
  planned_day_relative_to_boost specimen_type visit infancy_vac biological_sex
1                             0         Blood     1          wP         Female
2                             0         Blood     1          wP         Female
3                             0         Blood     1          wP         Female
4                             0         Blood     1          wP         Female
5                             0         Blood     1          wP         Female
6                             0         Blood     1          wP         Female
               ethnicity  race year_of_birth date_of_boost      dataset
1 Not Hispanic or Latino White    1986-01-01    2016-09-12 2020_dataset
2 Not Hispanic or Latino White    1986-01-01    2016-09-12 2020_dataset
3 Not Hispanic or Latino White    1986-01-01    2016-09-12 2020_dataset
4 Not Hispanic or Latino White    1986-01-01    2016-09-12 2020_dataset
5 Not Hispanic or Latino White    1986-01-01    2016-09-12 2020_dataset
6 Not Hispanic or Latino White    1986-01-01    2016-09-12 2020_dataset
         age
1 13481 days
2 13481 days
3 13481 days
4 13481 days
5 13481 days
6 13481 days</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q13. Complete the following code to make a summary boxplot of Ab titer levels for all antigens:</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>base_antigen <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(ig1) <span class="sc">+</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(MFI, antigen) <span class="sc">+</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>base_antigen</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class18_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>How do these change over time - one visualization that might be helpful is to facet the above plot by visit</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>base_antigen <span class="sc">+</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_wrap</span>(<span class="fu">vars</span>(visit), <span class="at">nrow=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class18_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Faceting by aP vs wP</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>base_antigen <span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">facet_wrap</span>(<span class="fu">vars</span>(ig1<span class="sc">$</span>infancy_vac), <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="class18_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>